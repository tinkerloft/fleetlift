version: 1
id: fleet-migration-with-threshold
title: "Migrate logging across services with failure threshold"

groups:
  - name: team-a
    repositories:
      - url: https://github.com/org/service-1.git
      - url: https://github.com/org/service-2.git
  - name: team-b
    repositories:
      - url: https://github.com/org/service-3.git
  - name: team-c
    repositories:
      - url: https://github.com/org/service-4.git
  - name: team-d
    repositories:
      - url: https://github.com/org/service-5.git

execution:
  agentic:
    prompt: "Migrate to slog for structured logging"
    verifiers:
      - name: build
        command: ["go", "build", "./..."]
      - name: test
        command: ["go", "test", "./..."]

max_parallel: 3

failure:
  threshold_percent: 20  # Pause if >20% of groups fail
  action: pause          # "pause" (default) or "abort"

require_approval: false
timeout: 30m
